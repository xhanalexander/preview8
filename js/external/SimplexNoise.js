THREE.SimplexNoise=function(t){null==t&&(t=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var i=0;i<256;i++)this.p[i]=Math.floor(256*t.random());this.perm=[];for(i=0;i<512;i++)this.perm[i]=this.p[255&i];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]},THREE.SimplexNoise.prototype.dot=function(t,i,r){return t[0]*i+t[1]*r},THREE.SimplexNoise.prototype.dot3=function(t,i,r,o){return t[0]*i+t[1]*r+t[2]*o},THREE.SimplexNoise.prototype.dot4=function(t,i,r,o,s){return t[0]*i+t[1]*r+t[2]*o+t[3]*s},THREE.SimplexNoise.prototype.noise=function(t,i){var r,o,s=(t+i)*(.5*(Math.sqrt(3)-1)),h=Math.floor(t+s),e=Math.floor(i+s),p=(3-Math.sqrt(3))/6,a=(h+e)*p,m=t-(h-a),d=i-(e-a);m>d?(r=1,o=0):(r=0,o=1);var n=m-r+p,l=d-o+p,f=m-1+2*p,M=d-1+2*p,u=255&h,E=255&e,g=this.perm[u+this.perm[E]]%12,x=this.perm[u+r+this.perm[E+o]]%12,c=this.perm[u+1+this.perm[E+1]]%12,H=.5-m*m-d*d,N=.5-n*n-l*l,R=.5-f*f-M*M;return 70*((H<0?0:(H*=H)*H*this.dot(this.grad3[g],m,d))+(N<0?0:(N*=N)*N*this.dot(this.grad3[x],n,l))+(R<0?0:(R*=R)*R*this.dot(this.grad3[c],f,M)))},THREE.SimplexNoise.prototype.noise3d=function(t,i,r){var o,s,h,e,p,a,m=(t+i+r)*(1/3),d=Math.floor(t+m),n=Math.floor(i+m),l=Math.floor(r+m),f=1/6,M=(d+n+l)*f,u=t-(d-M),E=i-(n-M),g=r-(l-M);u>=E?E>=g?(o=1,s=0,h=0,e=1,p=1,a=0):u>=g?(o=1,s=0,h=0,e=1,p=0,a=1):(o=0,s=0,h=1,e=1,p=0,a=1):E<g?(o=0,s=0,h=1,e=0,p=1,a=1):u<g?(o=0,s=1,h=0,e=0,p=1,a=1):(o=0,s=1,h=0,e=1,p=1,a=0);var x=u-o+f,c=E-s+f,H=g-h+f,N=u-e+2*f,R=E-p+2*f,S=g-a+2*f,T=u-1+.5,v=E-1+.5,y=g-1+.5,q=255&d,b=255&n,j=255&l,k=this.perm[q+this.perm[b+this.perm[j]]]%12,w=this.perm[q+o+this.perm[b+s+this.perm[j+h]]]%12,z=this.perm[q+e+this.perm[b+p+this.perm[j+a]]]%12,A=this.perm[q+1+this.perm[b+1+this.perm[j+1]]]%12,B=.6-u*u-E*E-g*g,C=.6-x*x-c*c-H*H,D=.6-N*N-R*R-S*S,F=.6-T*T-v*v-y*y;return 32*((B<0?0:(B*=B)*B*this.dot3(this.grad3[k],u,E,g))+(C<0?0:(C*=C)*C*this.dot3(this.grad3[w],x,c,H))+(D<0?0:(D*=D)*D*this.dot3(this.grad3[z],N,R,S))+(F<0?0:(F*=F)*F*this.dot3(this.grad3[A],T,v,y)))},THREE.SimplexNoise.prototype.noise4d=function(t,i,r,o){var s,h,e,p,a,m,d,n,l,f,M,u,E=this.grad4,g=this.simplex,x=this.perm,c=(Math.sqrt(5)-1)/4,H=(5-Math.sqrt(5))/20,N=(t+i+r+o)*c,R=Math.floor(t+N),S=Math.floor(i+N),T=Math.floor(r+N),v=Math.floor(o+N),y=(R+S+T+v)*H,q=t-(R-y),b=i-(S-y),j=r-(T-y),k=o-(v-y),w=(q>b?32:0)+(q>j?16:0)+(b>j?8:0)+(q>k?4:0)+(b>k?2:0)+(j>k?1:0),z=q-(s=g[w][0]>=3?1:0)+H,A=b-(h=g[w][1]>=3?1:0)+H,B=j-(e=g[w][2]>=3?1:0)+H,C=k-(p=g[w][3]>=3?1:0)+H,D=q-(a=g[w][0]>=2?1:0)+2*H,F=b-(m=g[w][1]>=2?1:0)+2*H,G=j-(d=g[w][2]>=2?1:0)+2*H,I=k-(n=g[w][3]>=2?1:0)+2*H,J=q-(l=g[w][0]>=1?1:0)+3*H,K=b-(f=g[w][1]>=1?1:0)+3*H,L=j-(M=g[w][2]>=1?1:0)+3*H,O=k-(u=g[w][3]>=1?1:0)+3*H,P=q-1+4*H,Q=b-1+4*H,U=j-1+4*H,V=k-1+4*H,W=255&R,X=255&S,Y=255&T,Z=255&v,$=x[W+x[X+x[Y+x[Z]]]]%32,_=x[W+s+x[X+h+x[Y+e+x[Z+p]]]]%32,tt=x[W+a+x[X+m+x[Y+d+x[Z+n]]]]%32,it=x[W+l+x[X+f+x[Y+M+x[Z+u]]]]%32,rt=x[W+1+x[X+1+x[Y+1+x[Z+1]]]]%32,ot=.6-q*q-b*b-j*j-k*k,st=.6-z*z-A*A-B*B-C*C,ht=.6-D*D-F*F-G*G-I*I,et=.6-J*J-K*K-L*L-O*O,pt=.6-P*P-Q*Q-U*U-V*V;return 27*((ot<0?0:(ot*=ot)*ot*this.dot4(E[$],q,b,j,k))+(st<0?0:(st*=st)*st*this.dot4(E[_],z,A,B,C))+(ht<0?0:(ht*=ht)*ht*this.dot4(E[tt],D,F,G,I))+(et<0?0:(et*=et)*et*this.dot4(E[it],J,K,L,O))+(pt<0?0:(pt*=pt)*pt*this.dot4(E[rt],P,Q,U,V)))};